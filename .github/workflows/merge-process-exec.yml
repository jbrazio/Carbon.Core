# 
#   ______ _______ ______ ______ _______ _______ 
#  |      |   _   |   __ \   __ \       |    |  |
#  |   ---|       |      <   __ <   -   |       |
#  |______|___|___|___|__|______/_______|__|____|
#                         discord.gg/eXPcNKK4yd
# 
name: ⤵️ merge-process-exec
concurrency: merge-process-exec

on:
  workflow_dispatch:
    inputs:
      source:
        description: 'From branch'
        required: true
        default: 'develop'
        type: choice
        options:
        - develop
        - staging
        - production
      target:
        description: 'Target branch'
        required: true
        default: 'staging'
        type: choice
        options:
        - develop
        - staging
        - production

jobs:
  merge:
    name: 🔃 Merge branches
    runs-on: ubuntu-latest

    steps:
    - name: 🔗 Checkout source code from github
      uses: actions/checkout@v3

    - name: Git config
      run: |
        git config --local user.email "actions@github.com"
        git config --local user.name "Github Actions"

    - name: ⤵️ Merge staging with production
      run: |
          git fetch --unshallow
          git checkout staging
          git pull
          git merge --no-ff develop -m "🤖 Merged ${{ inputs.target }} with ${{ inputs.source }}"
          git push